language: cpp

env:
  global:
    # Variables for Coverity scan
    - secure: "TmZV+akBvfWnMymseGFiZFq3lhwAwSQdt8vinJl/0W2Xxj5T0Muusvu0RR4LdR20sXiecL3LFFKXQEyfB7p82quxxQiP0R5vNtcHArBP7nuTpi/c/s6A1A6qCM6KdkgMFWdvJlJgSoUqSjMsBhVVbaJVxgxxyYPJDuuZsCgjd6I="
    - STANDARD_BUILD_COMMAND="make all -B"
    - COVERITY_SCAN_PROJECT_NAME="corporateshark/WalCommander"
    - COVERITY_SCAN_NOTIFICATION_EMAIL="konstantin.kuklin@gmail.com"
    # Regular expression selects on which branches to run analysis
    # Be aware of quotas. Do not run on every branch/commit
    - COVERITY_SCAN_BRANCH_PATTERN="coverity_scan"

    # Optionally execute a command immediately before cov-build, i.e.
    # pre-configuration required for the COVERITY_SCAN_BUILD_COMMAND
    - COVERITY_SCAN_BUILD_COMMAND_PREPEND=""

    # Insert the cov-build build commmand here
    - COVERITY_SCAN_BUILD_COMMAND=$STANDARD_BUILD_COMMAND

    # COVERITY_SCAN_TOKEN via "travis encrypt" using the repo's public key
    - COVERITY_SCAN_TOKEN: "H63P4YUW06rJCE+baggJpyx+thVj8t5TTEjgl3bbHP6X7k9CB3SC6D4gJKstUrZ+VI+Xf/as15Fxy+9ba+jrA6c+P8W6UCuOlFAdZWfjghoUpxNRoBdX37pYTXR9rZbbkKdQTTeIArXbTRuw2etBv4PlD1YIMCLdGUqKAzqIk7A="

    # ---- END Project-specific configuration

    - COVERITY_SCAN_BUILD_URL="https://gist.githubusercontent.com/KonstantinKuklin/63df870cb63519d49bce/raw"
    - COVERITY_SCAN_BUILD="curl -s $COVERITY_SCAN_BUILD_URL | bash"
    
    
before_script:
    - gcc -v
    - sudo add-apt-repository --yes ppa:ubuntu-toolchain-r/test
    - sudo apt-get update
    - sudo apt-get install gcc-4.8 g++-4.8
    - sudo update-alternatives --install /usr/bin/gcc gcc /usr/bin/gcc-4.8 20
    - sudo update-alternatives --install /usr/bin/g++ g++ /usr/bin/g++-4.8 20
    - sudo update-alternatives --config gcc
    - sudo update-alternatives --config g++
    - gcc -v 
    - cd ./wcm

compiler:
    - gcc
    - clang

script:
    - eval "$COVERITY_SCAN_BUILD"
